<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cXCMS">
<title>Tutorial • cXCMS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial">
<meta property="og:description" content="cXCMS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cXCMS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Tutorial.html">Run Locally</a>
    <a class="dropdown-item" href="../articles/HPC_workflow.html">HPC Workflow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tutorial</h1>
            
      
      
      <div class="d-none name"><code>Tutorial.Rmd</code></div>
    </div>

    
    
<p>The functions of this package are meant for large data sets compared
to the computer at hand. This means that all of the functions takes the
file path as input and outputs another file, which is saved to your SSD.
Hence, the computational demands are lifted off the RAM (on PCs) and for
High Performance Computing parallelization becomes feasible.</p>
<div class="section level2">
<h2 id="running-the-workflow-on-2-files">Running the workflow on 2 files<a class="anchor" aria-label="anchor" href="#running-the-workflow-on-2-files"></a>
</h2>
<div class="section level3">
<h3 id="peak-identification">Peak Identification<a class="anchor" aria-label="anchor" href="#peak-identification"></a>
</h3>
</div>
<div class="section level3">
<h3 id="defining-the-mzml-files-of-our-experiment-from-msdata-package">1. Defining the mzML files of our experiment (from msdata
package)<a class="anchor" aria-label="anchor" href="#defining-the-mzml-files-of-our-experiment-from-msdata-package"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"sciex"</span>, package <span class="op">=</span> <span class="st">"msdata"</span><span class="op">)</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">data_files</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "C:/Users/johan/AppData/Local/R/win-library/4.3/msdata/sciex/20171016_POOL_POS_1_105-134.mzML"</span></span>
<span><span class="co">## [2] "C:/Users/johan/AppData/Local/R/win-library/4.3/msdata/sciex/20171016_POOL_POS_3_105-134.mzML"</span></span></code></pre>
<p>On your system, you might want something like this:</p>
<pre><code><span><span class="va">data_folder</span> <span class="op">&lt;-</span> <span class="st">"~/path/to/experiment"</span></span>
<span><span class="va">data_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">data_folder</span>, recursive<span class="op">=</span><span class="cn">TRUE</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="setting-output-files">2. Setting output files<a class="anchor" aria-label="anchor" href="#setting-output-files"></a>
</h3>
<p>note that it is strongly advised to use .rds as file suffix although
all names should work</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peak_directory</span> <span class="op">&lt;-</span> <span class="st">"./tmp/peak_picked"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">peak_directory</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span>, showWarnings <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">peak_directory</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".*/"</span>, <span class="st">"/"</span>, <span class="va">data_files</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">peak_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">".mzML"</span>, <span class="st">".rds"</span>, <span class="va">peak_files</span><span class="op">)</span></span>
<span><span class="va">peak_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"_"</span>, <span class="va">peak_files</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peak_files</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "./tmp/peak_picked/20171016_POOL_POS_1_105_134.rds"</span></span>
<span><span class="co">## [2] "./tmp/peak_picked/20171016_POOL_POS_3_105_134.rds"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="running-peak-picking-on-one-file-at-a-time">3. Running peak picking on one file at a time<a class="anchor" aria-label="anchor" href="#running-peak-picking-on-one-file-at-a-time"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set the peak picking parameters</span></span>
<span><span class="va">cwp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/findChromPeaks-centWave.html" class="external-link">CentWaveParam</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">data_files</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">input</span>  <span class="op">&lt;-</span> <span class="va">data_files</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="va">output</span> <span class="op">&lt;-</span> <span class="va">peak_files</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># if file exists continue</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span><span class="op">)</span> <span class="kw">next</span></span>
<span>  </span>
<span>  <span class="fu">cXCMS</span><span class="fu">::</span><span class="fu"><a href="../reference/cFindChromPeaksStep1.html">cFindChromPeaksStep1</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">input</span>, output <span class="op">=</span> <span class="va">output</span>, cwp <span class="op">=</span> <span class="va">cwp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="merging-peak-picked-files-prior-to-peak-grouping">4. Merging peak picked files prior to peak grouping<a class="anchor" aria-label="anchor" href="#merging-peak-picked-files-prior-to-peak-grouping"></a>
</h3>
<p>This step has been highly optimized compared to previous methods,
reducing running time from nlog(n) to n. In practice this does not
matter for less than 1000 samples, but in the range of 5000-10000
samples we go from days to hours in processing time. In the +10000
sample range the old method was not viable at all. This function uses
the exact same function as the original method but uses a workaround to
avoid redundant checks.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_peak_identified</span> <span class="op">&lt;-</span> <span class="st">"./tmp/peak_picked_dataset.rds"</span></span>
<span><span class="fu"><a href="../reference/cFindChromPeaksStep2.html">cFindChromPeaksStep2</a></span><span class="op">(</span>inputs <span class="op">=</span> <span class="va">peak_files</span>, output <span class="op">=</span> <span class="va">output_peak_identified</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="grouping-1">Grouping 1<a class="anchor" aria-label="anchor" href="#grouping-1"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msobject</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="va">output_peak_identified</span><span class="op">)</span></span>
<span><span class="va">pdp</span>      <span class="op">&lt;-</span> <span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">PeakDensityParam</a></span><span class="op">(</span>sampleGroups <span class="op">=</span> <span class="va">msobject</span><span class="op">@</span><span class="va">phenoData</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">msobject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">groupChromPeaks</a></span><span class="op">(</span><span class="va">msobject</span>, <span class="va">pdp</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="alignment">Alignment<a class="anchor" aria-label="anchor" href="#alignment"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pgp</span>      <span class="op">&lt;-</span> <span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/adjustRtime.html" class="external-link">PeakGroupsParam</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">msobject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjustRtime.html">adjustRtime</a></span><span class="op">(</span><span class="va">msobject</span>, <span class="va">pgp</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Performing retention time correction using 10 peak groups.</span></span></code></pre>
<pre><code><span><span class="co">## Warning in do_adjustRtime_peakGroups(chromPeaks(object, msLevel = msLevel), :</span></span>
<span><span class="co">## Span too small for 'loess' and the available number of peak groups, resetting</span></span>
<span><span class="co">## to 0.4</span></span></code></pre>
<pre><code><span><span class="co">## Applying retention time adjustment to the identified chromatographic peaks ...</span></span></code></pre>
<pre><code><span><span class="co">## OK</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="grouping-2">Grouping 2<a class="anchor" aria-label="anchor" href="#grouping-2"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pdp</span>      <span class="op">&lt;-</span> <span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">PeakDensityParam</a></span><span class="op">(</span>sampleGroups <span class="op">=</span> <span class="va">msobject</span><span class="op">@</span><span class="va">phenoData</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="va">msobject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/groupChromPeaks.html" class="external-link">groupChromPeaks</a></span><span class="op">(</span><span class="va">msobject</span>, <span class="va">pdp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">output_integration_ready</span> <span class="op">&lt;-</span> <span class="st">"./tmp/integration_ready.rds"</span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">write_rds</a></span><span class="op">(</span><span class="va">msobject</span>, <span class="va">output_integration_ready</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="integration">Integration<a class="anchor" aria-label="anchor" href="#integration"></a>
</h3>
<p>This is the most memory consuming step in the analysis. Both in the
original xcms and this HPC optimized version.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fcp</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xcms/man/fillChromPeaks.html" class="external-link">FillChromPeaksParam</a></span><span class="op">(</span>expandMz <span class="op">=</span> <span class="fl">0</span>, expandRt <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">output_step1</span>  <span class="op">&lt;-</span> <span class="st">"./tmp/integration_package.rds"</span></span>
<span><span class="va">prepared_data</span> <span class="op">&lt;-</span> <span class="fu">cXCMS</span><span class="fu">::</span><span class="fu"><a href="../reference/cFillChromPeaksStep1.html">cFillChromPeaksStep1</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">output_integration_ready</span>, fcp <span class="op">=</span> <span class="va">fcp</span>, output <span class="op">=</span> <span class="va">output_step1</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="extracting-peaks-from-the-spectras">Extracting peaks from the spectras<a class="anchor" aria-label="anchor" href="#extracting-peaks-from-the-spectras"></a>
</h4>
<p>This is the memory intensive step. Beware that it will always rerun
all files as the peaks depend on previous steps</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Change subdir from peak_picked to integrated for the output files (n=sample size) of cFillChromPeaksStep2 step</span></span>
<span><span class="va">integration_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"peak_picked"</span>, <span class="st">"integrated"</span>, <span class="va">peak_files</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">integration_files</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/cFillChromPeaksStep2.html">cFillChromPeaksStep2</a></span><span class="op">(</span>input <span class="op">=</span> <span class="va">output_step1</span>, output <span class="op">=</span> <span class="va">integration_files</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, index <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## Requesting 3 peaks from 20171016_POOL_POS_1_105-134.mzML ... got 3.</span></span>
<span><span class="co">## Requesting 5 peaks from 20171016_POOL_POS_3_105-134.mzML ... got 5.</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="st">"./tmp/preprocessing_output.rds"</span></span>
<span><span class="fu"><a href="../reference/cFillChromPeaksStep3.html">cFillChromPeaksStep3</a></span><span class="op">(</span>inputFromStep1 <span class="op">=</span> <span class="va">output_step1</span>, inputFromStep2 <span class="op">=</span> <span class="va">integration_files</span>, output <span class="op">=</span> <span class="va">output</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Object of class:  FillChromPeaksParam </span></span>
<span><span class="co">##  Parameters:</span></span>
<span><span class="co">##  - expandMz: [1] 0</span></span>
<span><span class="co">##  - expandRt: [1] 0</span></span>
<span><span class="co">##  - ppm: [1] 0</span></span>
<span><span class="co">##  - fixedMz: [1] 0</span></span>
<span><span class="co">##  - fixedRt: [1] 0</span></span></code></pre>
<pre><code><span><span class="co">## NULL</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="output-of-preprocessing">Output of preprocessing<a class="anchor" aria-label="anchor" href="#output-of-preprocessing"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms_preprocessed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="va">feature_name</span>   <span class="op">&lt;-</span> </span>
<span>  <span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html" class="external-link">featureDefinitions</a></span><span class="op">(</span><span class="va">ms_preprocessed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>feature_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mzmed</span><span class="op">)</span>, <span class="st">"T"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">rtmed</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         feature_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/make.unique.html" class="external-link">make.unique</a></span><span class="op">(</span><span class="va">feature_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">feature_name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">feature_values</span>  <span class="op">&lt;-</span> </span>
<span>  <span class="fu">xcms</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xcms/man/XCMSnExp-peak-grouping-results.html" class="external-link">featureValues</a></span><span class="op">(</span><span class="va">ms_preprocessed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>feature_name <span class="op">=</span> <span class="va">feature_name</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">feature_name</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">feature_name</span>, values_from <span class="op">=</span> <span class="va">value</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="clean-all-intermediate-files"># clean all intermediate files<a class="anchor" aria-label="anchor" href="#clean-all-intermediate-files"></a>
</h2>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"tmp"</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
